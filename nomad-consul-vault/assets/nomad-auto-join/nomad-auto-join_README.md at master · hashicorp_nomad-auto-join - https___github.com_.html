<!DOCTYPE html>
<!-- saved from url=(0066)https://github.com/hashicorp/nomad-auto-join/blob/master/README.md -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
  <link rel="dns-prefetch" href="https://assets-cdn.github.com/">
  <link rel="dns-prefetch" href="https://avatars0.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars1.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars2.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com/">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">



  <link crossorigin="anonymous" href="./nomad-auto-join_README.md at master · hashicorp_nomad-auto-join - https___github.com__files/frameworks-c9193575f18b28be82c0a963e144ff6fa7a809dd8ae003a1d1e5979bed3f7f00.css" integrity="sha256-yRk1dfGLKL6CwKlj4UT/b6eoCd2K4AOh0eWXm+0/fwA=" media="all" rel="stylesheet">
  <link crossorigin="anonymous" href="./nomad-auto-join_README.md at master · hashicorp_nomad-auto-join - https___github.com__files/github-1214f71e8309b7d4dab489c2765c4de1523517be4c68b861a78d93c8e840648e.css" integrity="sha256-EhT3HoMJt9TatInCdlxN4VI1F75MaLhhp42TyOhAZI4=" media="all" rel="stylesheet">
  
  
  
  

  <meta name="viewport" content="width=device-width">
  
  <title>nomad-auto-join/README.md at master · hashicorp/nomad-auto-join - https://github.com/</title>
  <link rel="search" type="application/opensearchdescription+xml" href="https://github.com/opensearch.xml" title="GitHub">
  <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
  <meta property="fb:app_id" content="1401488693436528">

    
    <meta content="https://avatars0.githubusercontent.com/u/761456?s=400&amp;v=4" property="og:image"><meta content="GitHub" property="og:site_name"><meta content="object" property="og:type"><meta content="hashicorp/nomad-auto-join" property="og:title"><meta content="https://github.com/hashicorp/nomad-auto-join" property="og:url"><meta content="nomad-auto-join - Terraform config to automatically bootstrap a Nomad cluster" property="og:description">

  <link rel="assets" href="https://assets-cdn.github.com/">
  <link rel="web-socket" href="wss://live.github.com/_sockets/VjI6MTkzOTY2ODQ1OmUyYzgzOGQzOTFkMzc4NmVhMzZjOTRmZWZhOTdmNWY1YmIxNjQ0MTc1YjdkMzZhODIzOWE4NjAzOTBkNDY2ODc=--ca4a1927defe4c85cdb22c5134c9c086b0ec8bb8">
  <meta name="pjax-timeout" content="1000">
  <link rel="sudo-modal" href="https://github.com/sessions/sudo_modal">
  
  

  

  <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
<meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
<meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">
    <meta name="google-analytics" content="UA-3769691-2">

<meta content="collector.githubapp.com" name="octolytics-host"><meta content="github" name="octolytics-app-id"><meta content="https://collector.githubapp.com/github-external/browser_event" name="octolytics-event-url"><meta content="043B:2202:606B59:A4BEDD:5A257841" name="octolytics-dimension-request_id"><meta content="iad" name="octolytics-dimension-region_edge"><meta content="iad" name="octolytics-dimension-region_render"><meta content="1201644" name="octolytics-actor-id"><meta content="CumpsD" name="octolytics-actor-login"><meta content="cf9f780c97638d2888850ee33a25faad3e124f64589ce6222877bcb13e0e2d65" name="octolytics-actor-hash">





  <meta class="js-ga-set" name="dimension1" content="Logged In">


  

      <meta name="hostname" content="github.com">
  <meta name="user-login" content="CumpsD">

      <meta name="expected-hostname" content="github.com">
    <meta name="js-proxy-site-detection-payload" content="YTllM2JiYzU1OTI4YjUwNWVkMWY4YzA1OGYzYzNhYzU4YjBlYmM1YjExNDRkZWI3MzVkMTBiODBlNzE4NzU5Mnx7InJlbW90ZV9hZGRyZXNzIjoiMTkzLjE5MC43Ni41OCIsInJlcXVlc3RfaWQiOiIwNDNCOjIyMDI6NjA2QjU5OkE0QkVERDo1QTI1Nzg0MSIsInRpbWVzdGFtcCI6MTUxMjQwNTA1OCwiaG9zdCI6ImdpdGh1Yi5jb20ifQ==">

    <meta name="enabled-features" content="UNIVERSE_BANNER,FREE_TRIALS">

  <meta name="html-safe-nonce" content="c9baeeaf656b94bf24cb1950ce118eed8a2190ef">

  <meta http-equiv="x-pjax-version" content="54c93733751af8f7172595cab85f9b54">
  

      <link href="https://github.com/hashicorp/nomad-auto-join/commits/master.atom" rel="alternate" title="Recent Commits to nomad-auto-join:master" type="application/atom+xml">

  <meta name="description" content="nomad-auto-join - Terraform config to automatically bootstrap a Nomad cluster">
  <meta name="go-import" content="github.com/hashicorp/nomad-auto-join git https://github.com/hashicorp/nomad-auto-join.git">

  <meta content="761456" name="octolytics-dimension-user_id"><meta content="hashicorp" name="octolytics-dimension-user_login"><meta content="95550916" name="octolytics-dimension-repository_id"><meta content="hashicorp/nomad-auto-join" name="octolytics-dimension-repository_nwo"><meta content="true" name="octolytics-dimension-repository_public"><meta content="false" name="octolytics-dimension-repository_is_fork"><meta content="95550916" name="octolytics-dimension-repository_network_root_id"><meta content="hashicorp/nomad-auto-join" name="octolytics-dimension-repository_network_root_nwo"><meta content="false" name="octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown">


    


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://assets-cdn.github.com/pinned-octocat.svg" color="#000000">
  <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://assets-cdn.github.com/favicon.ico">

<meta name="theme-color" content="#1e2327">


  <meta name="u2f-support" content="true">

  <meta name="selected-link" value="repo_source" data-pjax-transient="true"><meta content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true" name="analytics-location"><meta name="request-id" content="F914:21FE:386536:62EA62:5A257846" data-pjax-transient="true"><link rel="canonical" href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md" data-pjax-transient="true"><link href="https://github.com/hashicorp/nomad-auto-join/commits/master.atom" rel="alternate" title="Recent Commits to nomad-auto-join:master" type="application/atom+xml" data-pjax-transient="true"></head>

  <body class="logged-in env-production intent-mouse">
    

  <div class="position-relative js-header-wrapper ">
    <a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#start-of-content" tabindex="1" class="bg-black text-white p-3 show-on-focus js-skip-to-content">Skip to content</a>
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress" style="transition: width 0.4s ease 0s; width: 100%;"></div></div>

    
    
    



        
<header class="Header  f5" role="banner">
  <div class="d-flex px-3 flex-justify-between container-lg">
    <div class="d-flex flex-justify-between">
      <a class="header-logo-invertocat" href="https://github.com/" data-hotkey="g d" aria-label="Homepage" data-ga-click="Header, go to dashboard, icon:logo">
  <svg aria-hidden="true" class="octicon octicon-mark-github" height="32" version="1.1" viewBox="0 0 16 16" width="32"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>


    </div>

    <div class="HeaderMenu d-flex flex-justify-between flex-auto">
      <div class="d-flex">
            <div class="">
              <div class="header-search scoped-search site-scoped-search js-site-search" role="search">
  <!-- '"` --><!-- </textarea></xmp> --><form accept-charset="UTF-8" action="https://github.com/hashicorp/nomad-auto-join/search" class="js-site-search-form" data-scoped-search-url="/hashicorp/nomad-auto-join/search" data-unscoped-search-url="/search" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"></div>
    <label class="form-control header-search-wrapper js-chromeless-input-container">
        <a href="https://github.com/hashicorp/nomad-auto-join" class="header-search-scope no-underline">This repository</a>
      <input type="text" class="form-control header-search-input js-site-search-focus js-site-search-field is-clearable" data-hotkey="s" name="q" value="" placeholder="Search" aria-label="Search this repository" data-unscoped-placeholder="Search GitHub" data-scoped-placeholder="Search" autocapitalize="off">
        <input type="hidden" class="js-site-search-type-field" name="type">
    </label>
</form></div>

            </div>

          <ul class="d-flex pl-2 flex-items-center text-bold list-style-none" role="navigation">
            <li>
              <a href="https://github.com/pulls" aria-label="Pull requests you created" class="js-selected-navigation-item HeaderNavlink px-2" data-ga-click="Header, click, Nav menu - item:pulls context:user" data-hotkey="g p" data-selected-links="/pulls /pulls/assigned /pulls/mentioned /pulls">
                Pull requests
</a>            </li>
            <li>
              <a href="https://github.com/issues" aria-label="Issues you created" class="js-selected-navigation-item HeaderNavlink px-2" data-ga-click="Header, click, Nav menu - item:issues context:user" data-hotkey="g i" data-selected-links="/issues /issues/assigned /issues/mentioned /issues">
                Issues
</a>            </li>
                <li>
                  <a href="https://github.com/marketplace" class="js-selected-navigation-item HeaderNavlink px-2" data-ga-click="Header, click, Nav menu - item:marketplace context:user" data-selected-links=" /marketplace">
                    Marketplace
</a>                </li>
            <li>
              <a href="https://github.com/explore" class="js-selected-navigation-item HeaderNavlink px-2" data-ga-click="Header, click, Nav menu - item:explore" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore">
                Explore
</a>            </li>
          </ul>
      </div>

      <div class="d-flex">
        
<ul class="user-nav d-flex flex-items-center list-style-none" id="user-links">
  <li class="dropdown js-menu-container">
    <span class="d-inline-block  px-2">
      
    <a href="https://github.com/notifications" aria-label="You have no unread notifications" class="notification-indicator tooltipped tooltipped-s  js-socket-channel js-notification-indicator" data-channel="notification-changed:1201644" data-ga-click="Header, go to notifications, icon:read" data-hotkey="g n">
        <span class="mail-status "></span>
        <svg aria-hidden="true" class="octicon octicon-bell" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M14 12v1H0v-1l.73-.58c.77-.77.81-2.55 1.19-4.42C2.69 3.23 6 2 6 2c0-.55.45-1 1-1s1 .45 1 1c0 0 3.39 1.23 4.16 5 .38 1.88.42 3.66 1.19 4.42l.66.58H14zm-7 4c1.11 0 2-.89 2-2H5c0 1.11.89 2 2 2z"></path></svg>
</a>
    </span>
  </li>

  <li class="dropdown js-menu-container">
    <details class="dropdown-details details-reset js-dropdown-details d-flex px-2 flex-items-center">
      <summary class="HeaderNavlink" aria-label="Create new…" data-ga-click="Header, create new, icon:add">
        <svg aria-hidden="true" class="octicon octicon-plus float-left mr-1 mt-1" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M12 9H7v5H5V9H0V7h5V2h2v5h5z"></path></svg>
        <span class="dropdown-caret mt-1"></span>
      </summary>

      <ul class="dropdown-menu dropdown-menu-sw">
        
<a class="dropdown-item" href="https://github.com/new" data-ga-click="Header, create new repository">
  New repository
</a>

  <a class="dropdown-item" href="https://github.com/new/import" data-ga-click="Header, import a repository">
    Import repository
  </a>

<a class="dropdown-item" href="https://gist.github.com/" data-ga-click="Header, create new gist">
  New gist
</a>

  <a class="dropdown-item" href="https://github.com/organizations/new" data-ga-click="Header, create new organization">
    New organization
  </a>



  <div class="dropdown-divider"></div>
  <div class="dropdown-header">
    <span title="hashicorp/nomad-auto-join">This repository</span>
  </div>
    <a class="dropdown-item" href="https://github.com/hashicorp/nomad-auto-join/issues/new" data-ga-click="Header, create new issue">
      New issue
    </a>

      </ul>
    </details>
  </li>

  <li class="dropdown js-menu-container">

    <details class="dropdown-details details-reset js-dropdown-details d-flex pl-2 flex-items-center">
      <summary class="HeaderNavlink name mt-1" aria-label="View profile and more" data-ga-click="Header, show menu, icon:avatar">
        <img alt="@CumpsD" class="avatar float-left mr-1" src="./nomad-auto-join_README.md at master · hashicorp_nomad-auto-join - https___github.com__files/1201644" height="20" width="20">
        <span class="dropdown-caret"></span>
      </summary>

      <ul class="dropdown-menu dropdown-menu-sw">
        <li class="dropdown-header header-nav-current-user css-truncate">
          Signed in as <strong class="css-truncate-target">CumpsD</strong>
        </li>

        <li class="dropdown-divider"></li>

        <li><a class="dropdown-item" href="https://github.com/CumpsD" data-ga-click="Header, go to profile, text:your profile">
          Your profile
        </a></li>
        <li><a class="dropdown-item" href="https://github.com/CumpsD?tab=stars" data-ga-click="Header, go to starred repos, text:your stars">
          Your stars
        </a></li>
          <li><a class="dropdown-item" href="https://gist.github.com/" data-ga-click="Header, your gists, text:your gists">Your Gists</a></li>

        <li class="dropdown-divider"></li>

        <li><a class="dropdown-item" href="https://help.github.com/" data-ga-click="Header, go to help, text:help">
          Help
        </a></li>

        <li><a class="dropdown-item" href="https://github.com/settings/profile" data-ga-click="Header, go to settings, icon:settings">
          Settings
        </a></li>

        <li><!-- '"` --><!-- </textarea></xmp> --><form accept-charset="UTF-8" action="https://github.com/logout" class="logout-form" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="u56JHBzPieLFAeyawMb0Xmadbugw69V8g1FhMtX6Q/YGKlMb/KSrtT7RpeBrhcHHW22++C+ggPC5AaVkK9fpfQ=="></div>
          <button type="submit" class="dropdown-item dropdown-signout" data-ga-click="Header, sign out, icon:logout">
            Sign out
          </button>
        </form></li>
      </ul>
    </details>
  </li>
</ul>


        <!-- '"` --><!-- </textarea></xmp> --><form accept-charset="UTF-8" action="https://github.com/logout" class="sr-only right-0" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="vDqwhUvhBF2meuWKjsq7TtEBNhcLICw6uDySHXosuekBjmqCq4omCl2qrPAliY7X7PHmBxRrebaCbFZLhAETYg=="></div>
          <button type="submit" class="dropdown-item dropdown-signout" data-ga-click="Header, sign out, icon:logout">
            Sign out
          </button>
</form>      </div>
    </div>
  </div>
</header>


      

  </div>

  <div id="start-of-content" class="show-on-focus"></div>

    <div id="js-flash-container">
</div>



  <div role="main">
        <div itemscope="" itemtype="http://schema.org/SoftwareSourceCode">
    <div id="js-repo-pjax-container" data-pjax-container=""><div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav ">
    <div class="repohead-details-container clearfix container ">

      <ul class="pagehead-actions">
  <li>
        <!-- '"` --><!-- </textarea></xmp> --><form accept-charset="UTF-8" action="https://github.com/notifications/subscribe" class="js-social-container" data-autosubmit="true" data-remote="true" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="8e4ckTOibi1Rik/KvlM4UlaI1M1Xa1arKcHqpSuSQXECUJXuaaQGQ0LqRH7CziBlnEh13HsyzaGW87V2FCqxlA=="></div>      <input class="form-control" id="repository_id" name="repository_id" type="hidden" value="95550916">

        <div class="select-menu js-menu-container js-select-menu">
          <a href="https://github.com/hashicorp/nomad-auto-join/subscription" class="btn btn-sm btn-with-count select-menu-button js-menu-target" role="button" aria-haspopup="true" aria-expanded="false" aria-label="Toggle repository notifications menu" data-ga-click="Repository, click Watch settings, action:blob#show">
            <span class="js-select-button">
                <svg aria-hidden="true" class="octicon octicon-eye" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                Watch
            </span>
          </a>
          <a class="social-count js-social-count" href="https://github.com/hashicorp/nomad-auto-join/watchers" aria-label="9 users are watching this repository">
            9
          </a>

        <div class="select-menu-modal-holder">
          <div class="select-menu-modal subscription-menu-modal js-menu-content">
            <div class="select-menu-header js-navigation-enable" tabindex="-1">
              <svg aria-label="Close" class="octicon octicon-x js-menu-close" height="16" role="img" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"></path></svg>
              <span class="select-menu-title">Notifications</span>
            </div>

              <div class="select-menu-list js-navigation-container" role="menu">

                <div class="select-menu-item js-navigation-item selected" role="menuitem" tabindex="0">
                  <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z"></path></svg>
                  <div class="select-menu-item-text">
                    <input checked="checked" id="do_included" name="do" type="radio" value="included">
                    <span class="select-menu-item-heading">Not watching</span>
                    <span class="description">Be notified when participating or @mentioned.</span>
                    <span class="js-select-button-text hidden-select-button-text">
                      <svg aria-hidden="true" class="octicon octicon-eye" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                      Watch
                    </span>
                  </div>
                </div>

                <div class="select-menu-item js-navigation-item " role="menuitem" tabindex="0">
                  <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z"></path></svg>
                  <div class="select-menu-item-text">
                    <input id="do_subscribed" name="do" type="radio" value="subscribed">
                    <span class="select-menu-item-heading">Watching</span>
                    <span class="description">Be notified of all conversations.</span>
                    <span class="js-select-button-text hidden-select-button-text">
                      <svg aria-hidden="true" class="octicon octicon-eye" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                        Unwatch
                    </span>
                  </div>
                </div>

                <div class="select-menu-item js-navigation-item " role="menuitem" tabindex="0">
                  <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z"></path></svg>
                  <div class="select-menu-item-text">
                    <input id="do_ignore" name="do" type="radio" value="ignore">
                    <span class="select-menu-item-heading">Ignoring</span>
                    <span class="description">Never be notified.</span>
                    <span class="js-select-button-text hidden-select-button-text">
                      <svg aria-hidden="true" class="octicon octicon-mute" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z"></path></svg>
                        Stop ignoring
                    </span>
                  </div>
                </div>

              </div>

            </div>
          </div>
        </div>
</form>
  </li>

  <li>
    
  <div class="js-toggler-container js-social-container starring-container ">
    <!-- '"` --><!-- </textarea></xmp> --><form accept-charset="UTF-8" action="https://github.com/hashicorp/nomad-auto-join/unstar" class="starred js-social-form" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="bgbxyxFhPZq+b4AuyC0odm6LMaI8zH6la96OVMmu5sQmasecH++ZopFtfOM0bV0LCw/7Ebap3nX+7F6CLpkedA=="></div>
      <input type="hidden" name="context" value="repository">
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Unstar hashicorp/nomad-auto-join" data-ga-click="Repository, click unstar button, action:blob#show; text:Unstar">
        <svg aria-hidden="true" class="octicon octicon-star" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74z"></path></svg>
        Unstar
      </button>
        <a class="social-count js-social-count" href="https://github.com/hashicorp/nomad-auto-join/stargazers" aria-label="26 users starred this repository">
          26
        </a>
</form>
    <!-- '"` --><!-- </textarea></xmp> --><form accept-charset="UTF-8" action="https://github.com/hashicorp/nomad-auto-join/star" class="unstarred js-social-form" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="VdQW0/zAyY2GEZwSdCWPyxBFC+f5sMu3ss7vdUAhdMIt+Vq+HWl7hQ4Hm5UvgnkWChKN54O+X94NHePLngUv3w=="></div>
      <input type="hidden" name="context" value="repository">
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Star this repository" title="Star hashicorp/nomad-auto-join" data-ga-click="Repository, click star button, action:blob#show; text:Star">
        <svg aria-hidden="true" class="octicon octicon-star" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74z"></path></svg>
        Star
      </button>
        <a class="social-count js-social-count" href="https://github.com/hashicorp/nomad-auto-join/stargazers" aria-label="26 users starred this repository">
          26
        </a>
</form>  </div>

  </li>

  <li>
          <a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#fork-destination-box" class="btn btn-sm btn-with-count" title="Fork your own copy of hashicorp/nomad-auto-join to your account" aria-label="Fork your own copy of hashicorp/nomad-auto-join to your account" rel="facebox" data-ga-click="Repository, show fork modal, action:blob#show; text:Fork">
              <svg aria-hidden="true" class="octicon octicon-repo-forked" height="16" version="1.1" viewBox="0 0 10 16" width="10"><path fill-rule="evenodd" d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
            Fork
          </a>

          <div id="fork-destination-box" style="display: none;">
            <h2 class="facebox-header" data-facebox-id="facebox-header">Where should we fork this repository?</h2>
            <include-fragment src="" class="js-fork-select-fragment fork-select-fragment" data-url="/hashicorp/nomad-auto-join/fork?fragment=1">
              <img alt="Loading" height="64" src="./nomad-auto-join_README.md at master · hashicorp_nomad-auto-join - https___github.com__files/octocat-spinner-128.gif" width="64">
            </include-fragment>
          </div>

    <a href="https://github.com/hashicorp/nomad-auto-join/network" class="social-count" aria-label="9 users forked this repository">
      9
    </a>
  </li>
</ul>

      <h1 class="public ">
  <svg aria-hidden="true" class="octicon octicon-repo" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
  <span class="author" itemprop="author"><a href="https://github.com/hashicorp" class="url fn" rel="author">hashicorp</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a href="https://github.com/hashicorp/nomad-auto-join" data-pjax="#js-repo-pjax-container">nomad-auto-join</a></strong>

</h1>

    </div>
    
<nav class="reponav js-repo-nav js-sidenav-container-pjax container" itemscope="" itemtype="http://schema.org/BreadcrumbList" role="navigation" data-pjax="#js-repo-pjax-container">

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a href="https://github.com/hashicorp/nomad-auto-join" class="js-selected-navigation-item reponav-item selected" data-hotkey="g c" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /hashicorp/nomad-auto-join" itemprop="url">
      <svg aria-hidden="true" class="octicon octicon-code" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"></path></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a href="https://github.com/hashicorp/nomad-auto-join/issues" class="js-selected-navigation-item reponav-item" data-hotkey="g i" data-selected-links="repo_issues repo_labels repo_milestones /hashicorp/nomad-auto-join/issues" itemprop="url">
        <svg aria-hidden="true" class="octicon octicon-issue-opened" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
        <span itemprop="name">Issues</span>
        <span class="Counter">1</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a href="https://github.com/hashicorp/nomad-auto-join/pulls" class="js-selected-navigation-item reponav-item" data-hotkey="g p" data-selected-links="repo_pulls /hashicorp/nomad-auto-join/pulls" itemprop="url">
      <svg aria-hidden="true" class="octicon octicon-git-pull-request" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
      <span itemprop="name">Pull requests</span>
      <span class="Counter">2</span>
      <meta itemprop="position" content="3">
</a>  </span>

    <a href="https://github.com/hashicorp/nomad-auto-join/projects" class="js-selected-navigation-item reponav-item" data-hotkey="g b" data-selected-links="repo_projects new_repo_project repo_project /hashicorp/nomad-auto-join/projects">
      <svg aria-hidden="true" class="octicon octicon-project" height="16" version="1.1" viewBox="0 0 15 16" width="15"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      Projects
      <span class="Counter">0</span>
</a>
    <a href="https://github.com/hashicorp/nomad-auto-join/wiki" class="js-selected-navigation-item reponav-item" data-hotkey="g w" data-selected-links="repo_wiki /hashicorp/nomad-auto-join/wiki">
      <svg aria-hidden="true" class="octicon octicon-book" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M3 5h4v1H3V5zm0 3h4V7H3v1zm0 2h4V9H3v1zm11-5h-4v1h4V5zm0 2h-4v1h4V7zm0 2h-4v1h4V9zm2-6v9c0 .55-.45 1-1 1H9.5l-1 1-1-1H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h5.5l1 1 1-1H15c.55 0 1 .45 1 1zm-8 .5L7.5 3H2v9h6V3.5zm7-.5H9.5l-.5.5V12h6V3z"></path></svg>
      Wiki
</a>

  <a href="https://github.com/hashicorp/nomad-auto-join/pulse" class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors dependency_graph pulse /hashicorp/nomad-auto-join/pulse">
    <svg aria-hidden="true" class="octicon octicon-graph" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"></path></svg>
    Insights
</a>

</nav>


  </div><div class="container new-discussion-timeline experiment-repo-nav">
  <div class="repository-content">

    
  <a href="https://github.com/hashicorp/nomad-auto-join/blob/82fd0d7ff38c0e91a9998138e10f764e3d897baf/README.md" class="d-none js-permalink-shortcut" data-hotkey="y">Permalink</a>

  <!-- blob contrib key: blob_contributors:v21:a12643660421d88b80c8e0a52bba07ac -->

  <div class="file-navigation js-zeroclipboard-container">
    
<div class="select-menu branch-select-menu js-menu-container js-select-menu float-left">
  <button class=" btn btn-sm select-menu-button js-menu-target css-truncate" data-hotkey="w" type="button" aria-label="Switch branches or tags" aria-expanded="false" aria-haspopup="true">
      <i>Branch:</i>
      <span class="js-select-button css-truncate-target">master</span>
  </button>

  <div class="select-menu-modal-holder js-menu-content js-navigation-container" data-pjax="">

    <div class="select-menu-modal">
      <div class="select-menu-header">
        <svg aria-label="Close" class="octicon octicon-x js-menu-close" height="16" role="img" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"></path></svg>
        <span class="select-menu-title">Switch branches/tags</span>
      </div>

      <div class="select-menu-filters">
        <div class="select-menu-text-filter">
          <input type="text" aria-label="Filter branches/tags" id="context-commitish-filter-field" class="form-control js-filterable-field js-navigation-enable" placeholder="Filter branches/tags">
        </div>
        <div class="select-menu-tabs">
          <ul>
            <li class="select-menu-tab">
              <a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#" data-tab-filter="branches" data-filter-placeholder="Filter branches/tags" class="js-select-menu-tab" role="tab">Branches</a>
            </li>
            <li class="select-menu-tab">
              <a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#" data-tab-filter="tags" data-filter-placeholder="Find a tag…" class="js-select-menu-tab" role="tab">Tags</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="branches" role="menu">

        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <a class="select-menu-item js-navigation-item js-navigation-open selected" href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md" data-name="master" data-skip-pjax="true" rel="nofollow">
              <svg aria-hidden="true" class="octicon octicon-check select-menu-item-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z"></path></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                master
              </span>
            </a>
        </div>

          <div class="select-menu-no-results">Nothing to show</div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="tags">
        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


        </div>

        <div class="select-menu-no-results">Nothing to show</div>
      </div>

    </div>
  </div>
</div>

    <div class="BtnGroup float-right">
      <a href="https://github.com/hashicorp/nomad-auto-join/find/master" class="js-pjax-capture-input btn btn-sm BtnGroup-item" data-pjax="" data-hotkey="t">
        Find file
      </a>
      <button aria-label="Copy file path to clipboard" class="js-zeroclipboard btn btn-sm BtnGroup-item tooltipped tooltipped-s" data-copied-hint="Copied!" type="button">Copy path</button>
    </div>
    <div class="breadcrumb js-zeroclipboard-target">
      <span class="repo-root js-repo-root"><span class="js-path-segment"><a href="https://github.com/hashicorp/nomad-auto-join"><span>nomad-auto-join</span></a></span></span><span class="separator">/</span><strong class="final-path">README.md</strong>
    </div>
  </div>


  

  <div class="commit-tease">
      <span class="float-right">
        <a class="commit-tease-sha" href="https://github.com/hashicorp/nomad-auto-join/commit/246fa03b6a24b7f899cefd31e75847578045d142" data-pjax="">
          246fa03
        </a>
        <relative-time datetime="2017-07-06T08:34:24Z" title="Jul 6, 2017, 10:34 AM GMT+2">on Jul 6</relative-time>
      </span>
      <div>
        <img alt="@nicholasjackson" class="avatar" height="20" src="./nomad-auto-join_README.md at master · hashicorp_nomad-auto-join - https___github.com__files/773533" width="20">
        <a href="https://github.com/nicholasjackson" class="user-mention" rel="contributor">nicholasjackson</a>
          <a href="https://github.com/hashicorp/nomad-auto-join/commit/246fa03b6a24b7f899cefd31e75847578045d142" class="message" data-pjax="true" title="Updated content">Updated content</a>
      </div>

    <div class="commit-tease-contributors">
      <button type="button" class="btn-link muted-link contributors-toggle" data-facebox="#blob_contributors_box">
        <strong>1</strong>
         contributor
      </button>
      
    </div>

    <div id="blob_contributors_box" style="display:none">
      <h2 class="facebox-header" data-facebox-id="facebox-header">Users who have contributed to this file</h2>
      <ul class="facebox-user-list" data-facebox-id="facebox-description">
          <li class="facebox-user-list-item">
            <img alt="@nicholasjackson" height="24" src="./nomad-auto-join_README.md at master · hashicorp_nomad-auto-join - https___github.com__files/773533(1)" width="24">
            <a href="https://github.com/nicholasjackson">nicholasjackson</a>
          </li>
      </ul>
    </div>
  </div>


  <div class="file">
    <div class="file-header">
  <div class="file-actions">

    <div class="BtnGroup">
      <a href="https://github.com/hashicorp/nomad-auto-join/raw/master/README.md" class="btn btn-sm BtnGroup-item" id="raw-url">Raw</a>
        <a href="https://github.com/hashicorp/nomad-auto-join/blame/master/README.md" class="btn btn-sm js-update-url-with-hash BtnGroup-item" data-hotkey="b">Blame</a>
      <a href="https://github.com/hashicorp/nomad-auto-join/commits/master/README.md" class="btn btn-sm BtnGroup-item" rel="nofollow">History</a>
    </div>

        <a class="btn-octicon tooltipped tooltipped-nw" href="github-windows://openRepo/https://github.com/hashicorp/nomad-auto-join?branch=master&amp;filepath=README.md" aria-label="Open this file in GitHub Desktop" data-ga-click="Repository, open with desktop, type:windows">
            <svg aria-hidden="true" class="octicon octicon-device-desktop" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M15 2H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5.34c-.25.61-.86 1.39-2.34 2h8c-1.48-.61-2.09-1.39-2.34-2H15c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 9H1V3h14v8z"></path></svg>
        </a>

        <!-- '"` --><!-- </textarea></xmp> --><form accept-charset="UTF-8" action="https://github.com/hashicorp/nomad-auto-join/edit/master/README.md" class="inline-form js-update-url-with-hash" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="+Ptd1npqEvD3ybHPJO2cF96TSowBX0XY2DXDzzdJxcpN/mDjNfI48b9+3/wR3TXZ6gcMhE/KcDtmWH1vuQjKIQ=="></div>
          <button class="btn-octicon tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and edit the file" data-hotkey="e" data-disable-with="">
            <svg aria-hidden="true" class="octicon octicon-pencil" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"></path></svg>
          </button>
</form>        <!-- '"` --><!-- </textarea></xmp> --><form accept-charset="UTF-8" action="https://github.com/hashicorp/nomad-auto-join/delete/master/README.md" class="inline-form" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="0bFO3HffiegiUARk+7FXU97ptyxgbEF4MhaYGEEx9nr5xQuNeu8hN/WfBmY6RQoWn0BLlSpU6Am+bFOMYh84Sg=="></div>
          <button class="btn-octicon btn-octicon-danger tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and delete the file" data-disable-with="">
            <svg aria-hidden="true" class="octicon octicon-trashcan" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"></path></svg>
          </button>
</form>  </div>

  <div class="file-info">
      341 lines (250 sloc)
      <span class="file-info-divider"></span>
    14.5 KB
  </div>
</div>

    
  <div id="readme" class="readme blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="text"><h1><a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#auto-bootstrapping-a-nomad-cluster" aria-hidden="true" class="anchor" id="user-content-auto-bootstrapping-a-nomad-cluster"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Auto-bootstrapping a Nomad cluster</h1>
<p>In a previous post, we explored how Consul discovers other agents <a href="https://github.com/hashicorp/nomad-auto-join/blob/master/blog/consul-auto-join-with-cloud-metadata">using cloud metadata to bootstrap a cluster</a>. This post looks at Nomad's auto-joining functionality and how we can use Terraform to create an autoscaled cluster.</p>
<p>Unlike Consul, Nomad's auto bootstrapping functionality does not use cloud metadata because when Nomad pairs with Consul, we inherit the functionality.  Consul's service discovery and health checking is the perfect platform to use for bootstrapping Nomad.</p>
<p>The startup process for the Nomad server or agent is as follows:</p>
<ol>
<li>The instance bootstraps and installs Nomad and Consul Agent</li>
<li>The init system starts Consul Agent</li>
<li>Consul Agent discovers the Consul cluster using AWS Metadata</li>
<li>The init system starts Nomad with the location of a locally running Consul agent</li>
<li>On start, Nomad queries the service catalog in Consul to discover other instances</li>
<li>Nomad joins the discovered instances</li>
</ol>
<p><a href="./nomad-auto-join_README.md at master · hashicorp_nomad-auto-join - https___github.com__files/68747470733a2f2f68797a7870682e6d656469612e7a65737479696f2e636f6d2f6e6f6d61645f6175746f5f6a" target="_blank"><img src="./nomad-auto-join_README.md at master · hashicorp_nomad-auto-join - https___github.com__files/68747470733a2f2f68797a7870682e6d656469612e7a65737479696f2e636f6d2f6e6f6d61645f6175746f5f6a" alt="Nomad bootstrap process" data-canonical-src="https://hyzxph.media.zestyio.com/nomad_auto_join.png" style="max-width:100%;"></a></p>
<p>For servers, we still require the initial number of instances that is expected in the bootstrap process to ensure that we have a healthy cluster before we start to schedule work.  The requirement for the initial cluster size is to ensure that the cluster can elect a leader and establish a quorum.</p>
<h2><a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#setting-up-a-nomad-cluster" aria-hidden="true" class="anchor" id="user-content-setting-up-a-nomad-cluster"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setting up a Nomad cluster</h2>
<p>The repository at <a href="https://github.com/hashicorp/nomad-auto-join">https://github.com/hashicorp/nomad-auto-join</a> includes an example Terraform configuration to demonstrate this functionality.  Clone this repository to your local filesystem:</p>
<div class="highlight highlight-source-shell"><pre>$ git clone https://github.com/hashicorp/nomad-auto-join</pre></div>
<p>To initiate and bootstrap the cluster, first set the following environment variables with your AWS credentials.</p>
<div class="highlight highlight-source-shell"><pre>$ <span class="pl-k">export</span> AWS_REGION = <span class="pl-s"><span class="pl-pds">"</span>[AWS_REGION]<span class="pl-pds">"</span></span>
$ <span class="pl-k">export</span> AWS_ACCESS_KEY = <span class="pl-s"><span class="pl-pds">"</span>[AWS_ACCESS_KEY]<span class="pl-pds">"</span></span>
$ <span class="pl-k">export</span> AWS_SECRET_ACCESS_KEY = <span class="pl-s"><span class="pl-pds">"</span>[AWS_SECRET_ACCESS_KEY]<span class="pl-pds">"</span></span></pre></div>
<p>There are many ways to authenticate to AWS with Terraform, for details of all the authentication options, please see the <a href="https://www.terraform.io/docs/providers/aws/" rel="nofollow">Terraform AWS provider documentation</a> for more information.</p>
<p>Once we have the environment variables set we can then initialise the terraform modules using the <code>terraform get</code> command.  Using modules in our setup allows us to keep our code dry.  For more information on this features please see the Terraform documentation: <a href="https://www.terraform.io/docs/modules/usage.html" rel="nofollow">https://www.terraform.io/docs/modules/usage.html</a></p>
<div class="highlight highlight-source-shell"><pre>$ terraform get</pre></div>
<p>We can then run <code>plan</code> to create check the configuration before running <code>apply</code> to create the resources</p>
<div class="highlight highlight-source-shell"><pre>$ terraform plan
Refreshing Terraform state in-memory prior to plan...
The refreshed state will be used to calculate this plan, but will not be
persisted to <span class="pl-k">local</span> or remote state storage.

<span class="pl-c"><span class="pl-c">#</span>..</span>
<span class="pl-c1">.</span>
Plan: 30 to add, 0 to change, 0 to destroy.</pre></div>
<p>Running <code>terraform apply</code> will create 5 <code>t2.micro</code> instances, 3 servers to form a quorum and 2 agents which run the jobs.  These settings are configurable in the terraform.tfvars file if you would like to change them.</p>
<div class="highlight highlight-source-shell"><pre>$ terraform apply</pre></div>
<p>Once this is all up and running, the Terraform output shows the details of the created servers and clients.</p>
<div class="highlight highlight-source-shell"><pre>Apply complete<span class="pl-k">!</span> Resources: 30 added, 0 changed, 0 destroyed.

The state of your infrastructure has been saved to the path
below. This state is required to modify and destroy your
infrastructure, so keep it safe. To inspect the <span class="pl-c1">complete</span> state
use the <span class="pl-s"><span class="pl-pds">`</span>terraform show<span class="pl-pds">`</span></span> command.

State path: 

Outputs:

alb_arn = arn:aws:elasticloadbalancing:eu-west-1:773674589724:loadbalancer/app/nomad-consul-external/3cca7be97ab6d28d
alb_dns = nomad-consul-external-723193890.eu-west-1.elb.amazonaws.com
ssh_host = 34.251.93.86</pre></div>
<p>Because the Nomad API is not exposed publicly, we need to log into the SSH host which is attached to the same VPC.</p>
<div class="highlight highlight-source-shell"><pre>ssh ubuntu@<span class="pl-s"><span class="pl-pds">$(</span>terraform output ssh_host<span class="pl-pds">)</span></span></pre></div>
<p>We can then run <code>nomad server-members</code> to see a list of the servers in the cluster.</p>
<div class="highlight highlight-source-shell"><pre>ubuntu@ip-10-1-1-216:<span class="pl-k">~</span>$ nomad server-members
Name                  Address     Port  Status  Leader  Protocol  Build  Datacenter  Region
ip-10-1-1-99.global   10.1.1.99   4648  alive   <span class="pl-c1">false</span>   2         0.5.6  dc1         global
ip-10-1-2-107.global  10.1.2.107  4648  alive   <span class="pl-c1">false</span>   2         0.5.6  dc1         global
ip-10-1-2-48.global   10.1.2.48   4648  alive   <span class="pl-c1">true</span>    2         0.5.6  dc1         global</pre></div>
<p>Moreover, we can run <code>nomad node-status</code> to see a list of the clients.</p>
<div class="highlight highlight-source-shell"><pre>ubuntu@ip-10-1-1-131:<span class="pl-k">~</span>$ nomad node-status
ID        DC   Name          Class   Drain  Status
ec268e26  dc1  ip-10-1-2-5   <span class="pl-k">&lt;</span>none<span class="pl-k">&gt;</span>  <span class="pl-c1">false</span>  ready
ec21954b  dc1  ip-10-1-1-44  <span class="pl-k">&lt;</span>none<span class="pl-k">&gt;</span>  <span class="pl-c1">false</span>  ready</pre></div>
<h2><a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#running-jobs-on-nomad" aria-hidden="true" class="anchor" id="user-content-running-jobs-on-nomad"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Running jobs on Nomad</h2>
<p>To run a job on Nomad, we need to create a job specification which defines the schema.   The job file uses the HashiCorp Configuration Language (HCL) that aims to strike a balance between a human readable and editable, and machine-friendly format.</p>
<p>The overall hierarchy of our job file is as follows:</p>
<ul>
<li>job
<ul>
<li>group
<ul>
<li>task</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Each file only has a single job. However, a job can have multiple groups, and each group may have multiple tasks.  When a group contains multiple tasks, Nomad co-locates these on the same client.  This hierarchy allows you the flexibility of configuring a single service or groups of services which define an application in the one file.</p>
<p>Let's take a look at the file jobs/syslog.hcl  which defines a system for running syslog-ng.</p>
<div class="highlight highlight-source-terraform"><pre>job <span class="pl-s">"</span><span class="pl-s">system_utils</span><span class="pl-s">"</span> {
  <span class="pl-smi">datacenters</span> <span class="pl-k">=</span> [<span class="pl-s">"</span><span class="pl-s">dc1</span><span class="pl-s">"</span>]
  <span class="pl-smi">type</span>        <span class="pl-k">=</span> <span class="pl-s">"</span><span class="pl-s">system</span><span class="pl-s">"</span>

 <span class="pl-c"><span class="pl-c">#</span> ...<span class="pl-c"></span></span>

  group <span class="pl-s">"</span><span class="pl-s">system_utils</span><span class="pl-s">"</span> {
    <span class="pl-en">constraint</span> {
      <span class="pl-smi">distinct_hosts</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>
    }

    <span class="pl-c"><span class="pl-c">#</span> ...<span class="pl-c"></span></span>

    task <span class="pl-s">"</span><span class="pl-s">syslog</span><span class="pl-s">"</span> {
      <span class="pl-smi">driver</span> <span class="pl-k">=</span> <span class="pl-s">"</span><span class="pl-s">docker</span><span class="pl-s">"</span>

      <span class="pl-c"><span class="pl-c">#</span> ...<span class="pl-c"></span></span>
      }
    }
  }
}</pre></div>
<h3><a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#job-stanza" aria-hidden="true" class="anchor" id="user-content-job-stanza"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Job Stanza</h3>
<p>The job stanza is the top most configuration in the job specification, in our job we are assigning the name "system_utils" this name must be globally unique across the whole cluster.</p>
<div class="highlight highlight-source-terraform"><pre>job <span class="pl-s">"</span><span class="pl-s">system_utils</span><span class="pl-s">"</span> {
  <span class="pl-smi">datacenters</span> <span class="pl-k">=</span> [<span class="pl-s">"</span><span class="pl-s">eu-west-1</span><span class="pl-s">"</span>, “eu-west-<span class="pl-c1">2</span>”]
  <span class="pl-smi">type</span>        <span class="pl-k">=</span> <span class="pl-s">"</span><span class="pl-s">system</span><span class="pl-s">"</span>

  <span class="pl-en">update</span> {
    <span class="pl-smi">stagger</span>      <span class="pl-k">=</span> <span class="pl-s">"</span><span class="pl-s">10s</span><span class="pl-s">"</span>
    <span class="pl-smi">max_parallel</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>
  }
<span class="pl-c"><span class="pl-c">#</span> ...<span class="pl-c"></span></span></pre></div>
<p>We are then setting the datacenter, which is a required option and which has no default.  We could have also specified the region which is another attribute for job placement.  The datacenters and region attributes allow fine-grained control over where a job runs.  For example, you may have the following cluster deployed:</p>
<ul>
<li>region: Europe-AWS
* datacenter: eu-west-1
* datacenter: eu-east-1</li>
</ul>
<p>The type definition allows you to set the three different job types that are available to the scheduler:</p>
<ul>
<li>service - long-lived services that should never go down</li>
<li>batch - short lived or periodic jobs</li>
<li>system - schedule job on all running on all clients which that meet the job’s constraint</li>
</ul>
<p><a href="https://www.nomadproject.io/docs/runtime/schedulers.html" rel="nofollow">https://www.nomadproject.io/docs/runtime/schedulers.html</a></p>
<p>The update stanza configures how we would like the job to be updated for example when we want to deploy a new version.  In our case the settings give us the capability to do rolling deploys:</p>
<ul>
<li>max_parallel configures the number of task groups updated at any one time</li>
<li>stagger specifies the delay between sets of updates</li>
</ul>
<p><a href="https://www.nomadproject.io/docs/job-specification/update.html" rel="nofollow">https://www.nomadproject.io/docs/job-specification/update.html</a></p>
<h3><a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#group-stanza" aria-hidden="true" class="anchor" id="user-content-group-stanza"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Group Stanza</h3>
<p>The next level is the group stanza, and the group stanza defines a series of tasks that should be co-located on the same Nomad client.  To determine on which client the tasks get placed, we can specify some constraints.  Constraints filter on attributes and metadata,</p>
<p>In our example we are only setting the constraint <code>distinct_host</code>, this means that we would never schedule any more than one group to the same host.  Constraints can also apply to the Task and Job level; this gives you complete flexibility over the placement, all constraints evaluate on a hierarchical level which starts at a Job level and filters down.</p>
<p>Full details on this capability can is available in the Nomad documentation:</p>
<p><a href="https://www.nomadproject.io/docs/job-specification/constraint.html" rel="nofollow">https://www.nomadproject.io/docs/job-specification/constraint.html</a></p>
<h3><a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#task-stanza" aria-hidden="true" class="anchor" id="user-content-task-stanza"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task Stanza</h3>
<p>The task stanza is an individual unit of work, such as running a Docker container or application.  If we take a look at our example, we are going to run the docker image syslog-ng.</p>
<div class="highlight highlight-source-terraform"><pre>    task <span class="pl-s">"</span><span class="pl-s">syslog</span><span class="pl-s">"</span> {
      <span class="pl-smi">driver</span> <span class="pl-k">=</span> <span class="pl-s">"</span><span class="pl-s">docker</span><span class="pl-s">"</span>

      <span class="pl-en">config</span> {
        <span class="pl-smi">image</span> <span class="pl-k">=</span> <span class="pl-s">"</span><span class="pl-s">balabit/syslog-ng</span>:<span class="pl-s">latest</span><span class="pl-s">"</span>

        <span class="pl-en">port_map</span> {
          <span class="pl-smi">udp</span> <span class="pl-k">=</span> <span class="pl-c1">514</span>
          <span class="pl-smi">tcp</span> <span class="pl-k">=</span> <span class="pl-c1">601</span>
        }
      }
<span class="pl-c"><span class="pl-c">//</span> ..<span class="pl-c"></span></span>
}</pre></div>
<p>The first attribute in this stanza is the <em>driver</em>; we are using the value <code>docker</code> as we would like to run a Docker container however many different values are possible:</p>
<ul>
<li>docker - run a docker container</li>
<li>exec - execute a particular command, isolating primitives of the operating system to limit the tasks access to resources</li>
<li>java - run a Java application packaged into a Jar file</li>
<li>lxc - run LXC application containers</li>
<li>qemu - execute any regular qemu image</li>
<li>raw_exec - execute a particular command with no isolation, runs the command as the same user as the Nomad process. Disabled by default</li>
<li>rkt - run CoreOS rkt application containers</li>
</ul>
<p>Finally, we are going to set the config for the task, which is unique to each driver.  For our task we are using the Docker driver, the minimum we can specify is the image attribute to select the docker image. However, the driver supports most of the parameters which could are passed directly to Docker with the <code>docker run</code> command.</p>
<p><a href="https://www.nomadproject.io/docs/drivers/docker.html" rel="nofollow">https://www.nomadproject.io/docs/drivers/docker.html</a></p>
<h3><a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#resources" aria-hidden="true" class="anchor" id="user-content-resources"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resources</h3>
<p>To ensure that Nomad correctly allocates the task to the client we need to specify the resources that it consumes.  The resources stanza allows us to set limits for the CPU and memory, and network that the task can consume.  By limiting the resources, we can bin pack more tasks onto a single instance. However, the tasks get throttled to these limits, if we set them too small, we could inadvertently reduce the performance of the running application.</p>
<div class="highlight highlight-source-terraform"><pre>      <span class="pl-en">resources</span> {
        <span class="pl-smi">cpu</span>    <span class="pl-k">=</span> <span class="pl-c1">500</span> <span class="pl-c"><span class="pl-c">#</span> 500 MHz<span class="pl-c"></span></span>
        <span class="pl-smi">memory</span> <span class="pl-k">=</span> <span class="pl-c1">256</span> <span class="pl-c"><span class="pl-c">#</span> 256MB<span class="pl-c"></span></span>

        <span class="pl-en">network</span> {
          <span class="pl-smi">mbits</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>

          port <span class="pl-s">"</span><span class="pl-s">udp</span><span class="pl-s">"</span> {
            <span class="pl-smi">static</span> <span class="pl-k">=</span> <span class="pl-s">"</span><span class="pl-s">514</span><span class="pl-s">"</span>
          }

          port <span class="pl-s">"</span><span class="pl-s">tcp</span><span class="pl-s">"</span> {
            <span class="pl-smi">static</span> <span class="pl-k">=</span> <span class="pl-s">"</span><span class="pl-s">601</span><span class="pl-s">"</span>
          }
        }</pre></div>
<p>The port section of the network stanza allows us to allocate ports either dynamically or statically; we reference the ports which were defined in the config stanza earlier.  In this example we are statically allocating the http and admin ports as we want to map these to the load balancer however if we only need ports available for internal use then we can omit the <code>static = “514”</code> from the configuration and Nomad with dynamically allocate the port number to the container.</p>
<p><a href="https://www.nomadproject.io/docs/job-specification/resources.html" rel="nofollow">https://www.nomadproject.io/docs/job-specification/resources.html</a></p>
<h3><a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#running-the-jobs" aria-hidden="true" class="anchor" id="user-content-running-the-jobs"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Running the jobs</h3>
<p>Now that we understand the job configuration let's now see how to execute a job on our cluster.  Log into the remote ssh server by running:</p>
<div class="highlight highlight-source-shell"><pre>$ ssh ubuntu@<span class="pl-s"><span class="pl-pds">$(</span>terraform output ssh_host<span class="pl-pds">)</span></span></pre></div>
<p>In this example we are using the terraform output variable for the <code>ssh_host</code> direct in our command, there is no need to cut and paste the IP address.</p>
<p>When the SSH host was provisioned it downloaded the two example job files from the GitHub repository, you should see two files, syslog.hcl and http_test.hcl in the home directory.
Like Terraform Nomad has a plan command which checks the syntax of our config file and determines if it can allocate the resources on the server, let’s run this command:</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-smi">$nomad</span> plan syslog.hcl
+ Job: <span class="pl-s"><span class="pl-pds">"</span>system_utils<span class="pl-pds">"</span></span>
+ Task Group: <span class="pl-s"><span class="pl-pds">"</span>system_utils<span class="pl-pds">"</span></span> (2 create)
  + Task: <span class="pl-s"><span class="pl-pds">"</span>syslog<span class="pl-pds">"</span></span> (forces create)

Scheduler dry-run:
- All tasks successfully allocated.

Job Modify Index: 0
To submit the job with version verification run:

nomad run -check-index 0 syslog.hcl

When running the job with the check-index flag, the job will only be run <span class="pl-k">if</span> the
server side version matches the job modify index returned. If the index has
changed, another user has modified the job and the plan<span class="pl-s"><span class="pl-pds">'</span>s results are</span>
<span class="pl-s">potentially invalid.                                                                                 </span></pre></div>
<p>We can now use the <code>nomad run -check-index 0 syslog.hcl</code> command to execute the plan and provision the application.</p>
<pre lang="bashl"><code>$nomad run syslog.hcl
==&gt; Monitoring evaluation "711e028a"
    Evaluation triggered by job "system_utils"
    Allocation "82d60ade" created: node "ec25ffd9", group "system_utils"
    Allocation "a449140e" created: node "ec2d8914", group "system_utils"
    Evaluation status changed: "pending" -&gt; "complete"
==&gt; Evaluation "711e028a" finished with status "complete"
</code></pre>
<p>We can check the status of the job by running the <code>nomad status system_utils</code> command, you will see that there has been 2 allocations one for each Nomad client.</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-smi">$nomad</span> status system_utils
ID            = system_utils
Name          = system_utils
Type          = system
Priority      = 50
Datacenters   = dc1
Status        = running
Periodic      = <span class="pl-c1">false</span>
Parameterized = <span class="pl-c1">false</span>

Summary
Task Group    Queued  Starting  Running  Failed  Complete  Lost
system_utils  0       0         2        0       0         0

Allocations
ID        Eval ID   Node ID   Task Group    Desired  Status   Created At
82d60ade  711e028a  ec25ffd9  system_utils  run      running  06/29/17 16:39:18 BST
a449140e  711e028a  ec2d8914  system_utils  run      running  06/29/17 16:39:18 BST</pre></div>
<p>Now we have seen how we can create a system job let’s create a standard job for the http-echo server.</p>
<div class="highlight highlight-source-terraform"><pre>$ nomad plan http_test.hcl 
<span class="pl-c"><span class="pl-c">#</span> ...<span class="pl-c"></span></span>
$ nomad run -check-index <span class="pl-c1">0</span> http_test.hcl
<span class="pl-c"><span class="pl-c">#</span> ...<span class="pl-c"></span></span></pre></div>
<div class="highlight highlight-source-shell"><pre>$ nomad status
ID     Type     Priority  Status
system_util   system   50        running
http-test  service  50        running</pre></div>
<p>If you open another terminal window and curl the external alb address you should see the following response.</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-smi">$curl</span> <span class="pl-s"><span class="pl-pds">$(</span>terraform output external_alb_dns<span class="pl-pds">)</span></span>
<span class="pl-s"><span class="pl-pds">'</span>hello world<span class="pl-pds">'</span></span></pre></div>
<h2><a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#destroying-the-cluster" aria-hidden="true" class="anchor" id="user-content-destroying-the-cluster"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Destroying the cluster</h2>
<p>Don’t forget that running resources in AWS incur cost, once you have finished with your cluster you can destroying by running:</p>
<div class="highlight highlight-source-shell"><pre>$ terraform destroy</pre></div>
<h2><a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md#summary" aria-hidden="true" class="anchor" id="user-content-summary"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Summary</h2>
<p>The auto-bootstrapping functionality built into Nomad and Consul makes it possible to manage and auto-scale our clusters easily and not restricted to AWS.  This capability is available for most major cloud providers.  We have barely scratched the surface on the capacity of Nomad, but I hope you can see how Nomads power and simplicity could be a real benefit to your infrastructure.</p>
</article>
  </div>

  </div>

  <button type="button" data-facebox="#jump-to-line" data-facebox-class="linejump" data-hotkey="l" class="d-none">Jump to Line</button>
  <div id="jump-to-line" style="display:none">
    <!-- '"` --><!-- </textarea></xmp> --><form accept-charset="UTF-8" action="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md" class="js-jump-to-line-form" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"></div>
      <input class="form-control linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line…" aria-label="Jump to line" autofocus="">
      <button type="submit" class="btn">Go</button>
</form>  </div>

  </div>
  <div class="modal-backdrop js-touch-events"></div>
</div></div>
  </div>

  </div>

      
<div class="footer container-lg px-3" role="contentinfo">
  <div class="position-relative d-flex flex-justify-between py-6 mt-6 f6 text-gray border-top border-gray-light ">
    <ul class="list-style-none d-flex flex-wrap ">
      <li class="mr-3">© 2017 <span title="0.33462s from unicorn-596768511-c5vtq">GitHub</span>, Inc.</li>
        <li class="mr-3"><a href="https://github.com/site/terms" data-ga-click="Footer, go to terms, text:terms">Terms</a></li>
        <li class="mr-3"><a href="https://github.com/site/privacy" data-ga-click="Footer, go to privacy, text:privacy">Privacy</a></li>
        <li class="mr-3"><a href="https://github.com/security" data-ga-click="Footer, go to security, text:security">Security</a></li>
        <li class="mr-3"><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a href="https://help.github.com/" data-ga-click="Footer, go to help, text:help">Help</a></li>
    </ul>

    <a href="https://github.com/" aria-label="Homepage" class="footer-octicon" title="GitHub">
      <svg aria-hidden="true" class="octicon octicon-mark-github" height="24" version="1.1" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>
    <ul class="list-style-none d-flex flex-wrap ">
        <li class="mr-3"><a href="https://github.com/contact" data-ga-click="Footer, go to contact, text:contact">Contact GitHub</a></li>
      <li class="mr-3"><a href="https://developer.github.com/" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li class="mr-3"><a href="https://training.github.com/" data-ga-click="Footer, go to training, text:training">Training</a></li>
      <li class="mr-3"><a href="https://shop.github.com/" data-ga-click="Footer, go to shop, text:shop">Shop</a></li>
        <li class="mr-3"><a href="https://github.com/blog" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a href="https://github.com/about" data-ga-click="Footer, go to about, text:about">About</a></li>

    </ul>
  </div>
</div>



  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg aria-hidden="true" class="octicon octicon-alert" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M8.865 1.52c-.18-.31-.51-.5-.87-.5s-.69.19-.87.5L.275 13.5c-.18.31-.18.69 0 1 .19.31.52.5.87.5h13.7c.36 0 .69-.19.86-.5.17-.31.18-.69.01-1L8.865 1.52zM8.995 13h-2v-2h2v2zm0-3h-2V6h2v4z"></path></svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg aria-hidden="true" class="octicon octicon-x" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"></path></svg>
    </button>
    You can't perform that action at this time.
  </div>


    
    <script crossorigin="anonymous" integrity="sha256-R7c3eUp64zkx0aUKgHD8RyBMQTxCRYqXgUMLHeA4450=" src="./nomad-auto-join_README.md at master · hashicorp_nomad-auto-join - https___github.com__files/frameworks-47b737794a7ae33931d1a50a8070fc47204c413c42458a9781430b1de038e39d.js.download"></script>
    
    <script async="async" crossorigin="anonymous" integrity="sha256-BkfVzjK95QFZdckEBfHYBdvPVmpHjoEsYxab3pNK3wA=" src="./nomad-auto-join_README.md at master · hashicorp_nomad-auto-join - https___github.com__files/github-0647d5ce32bde5015975c90405f1d805dbcf566a478e812c63169bde934adf00.js.download"></script>
    
    
    
    
  <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner d-none">
    <svg aria-hidden="true" class="octicon octicon-alert" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M8.865 1.52c-.18-.31-.51-.5-.87-.5s-.69.19-.87.5L.275 13.5c-.18.31-.18.69 0 1 .19.31.52.5.87.5h13.7c.36 0 .69-.19.86-.5.17-.31.18-.69.01-1L8.865 1.52zM8.995 13h-2v-2h2v2zm0-3h-2V6h2v4z"></path></svg>
    <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md">Reload</a> to refresh your session.</span>
    <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="https://github.com/hashicorp/nomad-auto-join/blob/master/README.md">Reload</a> to refresh your session.</span>
  </div>
  <div class="facebox" id="facebox" style="display:none;">
  <div class="facebox-popup">
    <div class="facebox-content" role="dialog" aria-labelledby="facebox-header" aria-describedby="facebox-description">
    </div>
    <button type="button" class="facebox-close js-facebox-close" aria-label="Close modal">
      <svg aria-hidden="true" class="octicon octicon-x" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"></path></svg>
    </button>
  </div>
</div>


  


</body></html>